<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>บทที่ 2: ประเภทของเซต</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@200;300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
    --primary-color: #4f46e5;
    --secondary-color: #06b6d4;
    --success-color: #10b981;
    --warning-color: #f59e0b;
    --error-color: #ef4444;
    --bg-light: #f8fafc;
    --bg-white: #ffffff;
    --text-primary: #1e293b;
    --text-secondary: #64748b;
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
}

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, var(--bg-light) 0%, #e2e8f0 100%);
            min-height: 100vh;
            color: var(--text-primary);
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            background: var(--bg-white);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            width: 25%;
            transition: width 0.3s ease;
        }

        .lesson-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .xp-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.2rem;
            color: var(--primary-color);
            font-weight: 600;
        }

        .theory-card {
            background: var(--bg-white);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-md);
        }

        .theory-card h3 {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .theory-content {
            line-height: 1.8;
            color: var(--text-primary);
        }

        .example-box {
            background: #f1f5f9;
            border-left: 4px solid var(--primary-color);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 10px 10px 0;
        }

        .game-container {
            background: var(--bg-white);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-md);
        }

        .game-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 1rem;
            text-align: center;
        }

        .cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .flip-card {
            background-color: transparent;
            width: 100%;
            height: 200px;
            perspective: 1000px;
            cursor: pointer;
        }

        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }

        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: 1rem;
            box-shadow: var(--shadow-sm);
        }

        .flip-card-front {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .flip-card-back {
            background: linear-gradient(135deg, var(--success-color), #45a049);
            color: white;
            transform: rotateY(180deg);
        }

        .card-question {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .card-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .card-answer {
            font-size: 1rem;
            line-height: 1.5;
            text-align: center;
        }

        .score-display {
            text-align: center;
            font-size: 1.3rem;
            color: var(--primary-color);
            margin: 2rem 0;
            font-weight: 600;
        }

        .buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Kanit', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f5f5f5;
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .result-message {
            text-align: center;
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: 600;
            display: none;
        }

        .result-message.success {
            background: #d1fae5;
            color: var(--success-color);
            border: 2px solid var(--success-color);
        }

        .result-message.error {
            background: #fee2e2;
            color: var(--error-color);
            border: 2px solid var(--error-color);
        }

        /* Pulse animation for cards */
        .flip-card.correct {
            animation: pulse-green 0.6s ease-in-out;
        }

        .flip-card.incorrect {
            animation: pulse-red 0.6s ease-in-out;
        }

        @keyframes pulse-green {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 0 20px rgba(16, 185, 129, 0.5); }
            100% { transform: scale(1); }
        }

        @keyframes pulse-red {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 0 20px rgba(239, 68, 68, 0.5); }
            100% { transform: scale(1); }
        }

        /* Confetti Animation */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--primary-color);
            animation: confetti-fall 3s linear infinite;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .lesson-title {
                font-size: 2rem;
            }

            .buttons {
                flex-direction: column;
            }

            .cards-container {
                grid-template-columns: 1fr;
            }
        }

        /* เพิ่ม shake effect CSS */
        .flip-card.shake .flip-card-inner {
            animation: shake 0.4s;
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            20% { transform: translateX(-10px); }
            40% { transform: translateX(10px); }
            60% { transform: translateX(-10px); }
            80% { transform: translateX(10px); }
            100% { transform: translateX(0); }
        }
        .card-choices {
            margin-top: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .card-choices button {
            background: #f1f5f9;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            padding: 0.5rem 1rem;
            font-size: 1rem;
            font-family: 'Kanit', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }
        .card-choices button:hover {
            background: var(--primary-color);
            color: #fff;
        }
        .card-choices-grid {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
    gap: 10px;
    pointer-events: none;
    z-index: 2;
    padding: 18px;
    box-sizing: border-box;
}
.card-choices-grid button {
    width: 100%;
    height: 100%;
    min-width: 0;
    min-height: 0;
    border-radius: 18px;
    border: 2px solid var(--primary-color);
    background: #f1f5f9;
    color: var(--primary-color);
    font-size: 1.1rem;
    font-family: 'Kanit', sans-serif;
    font-weight: 600;
    cursor: pointer;
    opacity: 0;
    pointer-events: auto;
    transition: background 0.2s, color 0.2s, opacity 0.2s;
    box-shadow: 0 2px 8px rgba(79,70,229,0.08);
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 0.5rem;
}
.card-choices-grid button:hover {
    background: var(--primary-color);
    color: #fff;
}
.flip-card-front:hover .card-choices-grid button,
.flip-card-front:focus-within .card-choices-grid button {
    opacity: 1;
}
.flip-card.incorrect .flip-card-front {
    border: 3px solid var(--error-color);
    box-shadow: 0 0 0 4px #fee2e2;
}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <h1 class="lesson-title">📚 บทที่ 2: ประเภทของเซต</h1>
            <div class="xp-display">
    <span id="xp-display">XP: 0</span>
</div>
        </div>

        <div class="theory-card">
            <h3>📖 ทฤษฎีประเภทของเซต</h3>
            <div class="theory-content">
                <p>เซตสามารถแบ่งประเภทได้ตามจำนวนสมาชิก:</p>
                
                <div class="example-box">
                    <strong>1. เซตว่าง (Empty Set)</strong><br>
                    • สัญลักษณ์: ∅ หรือ { }<br>
                    • เซตที่ไม่มีสมาชิกเลย<br>
                    • ตัวอย่าง: เซตของมังกรที่มีจริง = ∅
                </div>

                <div class="example-box">
                    <strong>2. เซตจำกัด (Finite Set)</strong><br>
                    • เซตที่มีสมาชิกจำนวนจำกัด<br>
                    • ตัวอย่าง: A = {1, 2, 3, 4, 5}<br>
                    • จำนวนสมาชิก |A| = 5
                </div>

                <div class="example-box">
                    <strong>3. เซตอนันต์ (Infinite Set)</strong><br>
                    • เซตที่มีสมาชิกจำนวนไม่จำกัด<br>
                    • ตัวอย่าง: ℕ = {1, 2, 3, 4, ...}<br>
                    • เซตของจำนวนธรรมชาติ
                </div>

                <div class="example-box">
                    <strong>4. เซตเอกภพ (Universal Set)</strong><br>
                    • สัญลักษณ์: U<br>
                    • เซตที่ประกอบด้วยสมาชิกทั้งหมดที่เราสนใจ<br>
                    • ตัวอย่าง: U = {นักเรียนทั้งหมดในห้อง}
                </div>
            </div>
        </div>

        <div class="game-container">
            <h2 class="game-title">🎮 เกมการ์ดพลิก: ทายประเภทเซต</h2>
            <p style="text-align: center; color: #666; margin-bottom: 2rem;">คลิกการ์ดเพื่อดูคำถาม แล้วคลิกอีกครั้งเพื่อดูคำตอบ</p>
            
            <div class="score-display">
                คะแนน: <span id="gameScore">0</span> / <span id="totalCards">6</span>
            </div>

            <div class="cards-container">
                <div class="flip-card" data-index="0">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <div class="card-icon">🤔</div>
                            <div class="card-question">A = { }<br><br>เซตนี้เป็นประเภทใด?</div>
                            <div class="card-choices-grid">
                                <button tabindex="0" onclick="chooseCornerAnswer(event,0,0)">เซตว่าง</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,0,1)">เซตจำกัด</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,0,2)">เซตอนันต์</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,0,3)">เซตเอกภพ</button>
                            </div>
                        </div>
                        <div class="flip-card-back">
                            <div class="card-icon">✅</div>
                            <div class="card-answer">เซตว่าง (Empty Set)<br><br>เพราะไม่มีสมาชิกเลย<br>สัญลักษณ์: ∅</div>
                        </div>
                    </div>
                </div>
                <div class="flip-card" data-index="1">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <div class="card-icon">🧮</div>
                            <div class="card-question">B = {1, 2, 3, 4, 5}<br><br>เซตนี้เป็นประเภทใด?</div>
                            <div class="card-choices-grid">
                                <button tabindex="0" onclick="chooseCornerAnswer(event,1,0)">เซตว่าง</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,1,1)">เซตจำกัด</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,1,2)">เซตอนันต์</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,1,3)">เซตเอกภพ</button>
                            </div>
                        </div>
                        <div class="flip-card-back">
                            <div class="card-icon">✅</div>
                            <div class="card-answer">เซตจำกัด (Finite Set)<br><br>มีสมาชิก 5 ตัว<br>จำนวนจำกัด</div>
                        </div>
                    </div>
                </div>
                <div class="flip-card" data-index="2">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <div class="card-icon">∞</div>
                            <div class="card-question">C = {1, 2, 3, 4, ...}<br><br>เซตนี้เป็นประเภทใด?</div>
                            <div class="card-choices-grid">
                                <button tabindex="0" onclick="chooseCornerAnswer(event,2,0)">เซตว่าง</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,2,1)">เซตจำกัด</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,2,2)">เซตอนันต์</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,2,3)">เซตเอกภพ</button>
                            </div>
                        </div>
                        <div class="flip-card-back">
                            <div class="card-icon">✅</div>
                            <div class="card-answer">เซตอนันต์ (Infinite Set)<br><br>มีสมาชิกไม่จำกัด<br>จำนวนธรรมชาติ</div>
                        </div>
                    </div>
                </div>
                <div class="flip-card" data-index="3">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <div class="card-icon">🌍</div>
                            <div class="card-question">D = {นักเรียนทั้งหมดในโรงเรียน}<br><br>เซตนี้เป็นประเภทใด?</div>
                            <div class="card-choices-grid">
                                <button tabindex="0" onclick="chooseCornerAnswer(event,3,0)">เซตว่าง</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,3,1)">เซตจำกัด</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,3,2)">เซตอนันต์</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,3,3)">เซตเอกภพ</button>
                            </div>
                        </div>
                        <div class="flip-card-back">
                            <div class="card-icon">✅</div>
                            <div class="card-answer">เซตเอกภพ (Universal Set)<br><br>ประกอบด้วยสมาชิกทั้งหมด<br>ที่เราสนใจ</div>
                        </div>
                    </div>
                </div>
                <div class="flip-card" data-index="4">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <div class="card-icon">🦄</div>
                            <div class="card-question">E = {ยูนิคอร์นที่มีอยู่จริง}<br><br>เซตนี้เป็นประเภทใด?</div>
                            <div class="card-choices-grid">
                                <button tabindex="0" onclick="chooseCornerAnswer(event,4,0)">เซตว่าง</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,4,1)">เซตจำกัด</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,4,2)">เซตอนันต์</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,4,3)">เซตเอกภพ</button>
                            </div>
                        </div>
                        <div class="flip-card-back">
                            <div class="card-icon">✅</div>
                            <div class="card-answer">เซตว่าง (Empty Set)<br><br>เพราะไม่มียูนิคอร์น<br>ในความเป็นจริง</div>
                        </div>
                    </div>
                </div>
                <div class="flip-card" data-index="5">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <div class="card-icon">🔢</div>
                            <div class="card-question">F = {จำนวนเต็มลบ}<br><br>เซตนี้เป็นประเภทใด?</div>
                            <div class="card-choices-grid">
                                <button tabindex="0" onclick="chooseCornerAnswer(event,5,0)">เซตว่าง</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,5,1)">เซตจำกัด</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,5,2)">เซตอนันต์</button>
                                <button tabindex="0" onclick="chooseCornerAnswer(event,5,3)">เซตเอกภพ</button>
                            </div>
                        </div>
                        <div class="flip-card-back">
                            <div class="card-icon">✅</div>
                            <div class="card-answer">เซตอนันต์ (Infinite Set)<br><br>มีจำนวนเต็มลบ<br>ไม่จำกัด</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="result-message" id="resultMessage"></div>

            <div class="buttons">
                <button class="btn btn-primary" onclick="finishLesson()">🎉 เสร็จสิ้นบทเรียน</button>
                <button class="btn btn-secondary" onclick="resetGame()">🔄 เริ่มใหม่</button>
                <button class="btn btn-secondary" onclick="goHome()">🏠 กลับเมนู</button>
            </div>
        </div>
    </div>

    <script>
        // ข้อมูลเกม
        let gameData = {
            currentXP: 0,
            stars: 0,
            flippedCards: [],
            gameScore: 0,
            totalCards: 6
        };

        // คำตอบที่ถูกต้องของแต่ละการ์ด (index ของปุ่ม)
const correctAnswers = [0, 1, 2, 3, 0, 2];
let answeredCards = [false, false, false, false, false, false];
let totalAnswered = 0;
let xpGranted = false;

function chooseCornerAnswer(e, cardIdx, choiceIdx) {
    e.stopPropagation();
    const card = document.querySelector(`.flip-card[data-index="${cardIdx}"]`);
    if (answeredCards[cardIdx] || card.classList.contains('flipped')) return;

    if (choiceIdx === correctAnswers[cardIdx]) {
        // Correct
        answeredCards[cardIdx] = true;
        totalAnswered++;
        card.classList.remove('incorrect');
        card.classList.add('flipped');
        playSound('success');
        setTimeout(() => {
            card.classList.add('correct');
            setTimeout(() => card.classList.remove('correct'), 600);
        }, 300);
        updateScore();
        checkAllAnswered();
    } else {
        // Incorrect
        card.classList.remove('incorrect');
        void card.offsetWidth;
        card.classList.add('incorrect');
        playSound('click');
    }
}

function updateScore() {
    document.getElementById('gameScore').textContent = totalAnswered;
}

function resetGame() {
    answeredCards = [false, false, false, false, false, false];
    totalAnswered = 0;
    xpGranted = false;
    // Reset all cards
    const cards = document.querySelectorAll('.flip-card');
    cards.forEach(card => {
        card.classList.remove('flipped', 'correct', 'incorrect');
    });
    // Hide result
    document.getElementById('resultMessage').style.display = 'none';
    updateScore();
    playSound('click');
}

// เริ่มต้นเกม
        function initGame() {
            loadProgress();
            updateUI();
        }

        // ตรวจสอบการ์ดทั้งหมด
        function finishLesson() {
            if (totalAnswered === correctAnswers.length && !xpGranted) {
                // Add XP and sync with index/home
                if (window.opener && window.opener.setTheoryUtils) {
                    window.opener.setTheoryUtils.addXP(100);
                    window.opener.setTheoryUtils.completeLessonFromChild(2);
                } else if (window.setTheoryUtils) {
                    window.setTheoryUtils.addXP(100);
                    window.setTheoryUtils.completeLessonFromChild(2);
                } else {
                    let xp = parseInt(localStorage.getItem('setTheoryXP') || '0', 10);
                    xp += 100;
                    localStorage.setItem('setTheoryXP', xp);
                    localStorage.setItem('lesson2_completed', 'true');
                }
                xpGranted = true;
                document.getElementById('resultMessage').textContent = '🎉 ยินดีด้วย! คุณเสร็จสิ้นบทเรียนที่ 2 แล้ว\nได้รับ 100 XP!';
                document.getElementById('resultMessage').className = 'result-message success';
                document.getElementById('resultMessage').style.display = 'block';
                showConfetti();
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 1200);
            } else if (totalAnswered !== correctAnswers.length) {
                document.getElementById('resultMessage').textContent = '⚠️ กรุณาตอบให้ครบทุกข้อก่อนจบบทเรียน';
                document.getElementById('resultMessage').className = 'result-message error';
                document.getElementById('resultMessage').style.display = 'block';
                playSound('click');
            }
        }

        // อัปเดต UI
        function updateUI() {
            document.getElementById('currentXP').textContent = gameData.currentXP;
            document.getElementById('currentStars').textContent = gameData.stars;
            document.getElementById('progressFill').style.width = '25%'; // 2/8 lessons
        }

        // โหลดความคืบหน้า
        function loadProgress() {
            const saved = localStorage.getItem('setTheoryProgress');
            if (saved) {
                const savedData = JSON.parse(saved);
                gameData.currentXP = savedData.totalXP || 0;
                gameData.stars = savedData.totalStars || 0;
            }
        }

        // บันทึกความคืบหน้า
function saveProgress() {
    const saved = localStorage.getItem('setTheoryProgress');
    let progressData = saved ? JSON.parse(saved) : {
        totalXP: 0,
        completedLessons: 0,
        totalStars: 0,
        lessonProgress: {}
    };
    progressData.totalXP = gameData.currentXP;
    progressData.totalStars = gameData.stars;
    progressData.lessonProgress[2] = {
        completed: true,
        xp: 100,
        stars: 3
    };
    // นับบทเรียนที่เสร็จ
    progressData.completedLessons = Object.keys(progressData.lessonProgress).length;
    localStorage.setItem('setTheoryProgress', JSON.stringify(progressData));
}

// เล่นเสียง
        function playSound(type) {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            switch(type) {
                case 'flip':
                    oscillator.frequency.value = 600;
                    oscillator.type = 'sine';
                    gainNode.gain.value = 0.2;
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.1);
                    break;
                    
                case 'success':
                    // เสียงแจ้งเตือนสำเร็จ
                    oscillator.frequency.value = 523.25; // C5
                    oscillator.type = 'sine';
                    gainNode.gain.value = 0.3;
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.2);
                    
                    setTimeout(() => {
                        const osc2 = audioContext.createOscillator();
                        const gain2 = audioContext.createGain();
                        osc2.connect(gain2);
                        gain2.connect(audioContext.destination);
                        osc2.frequency.value = 659.25; // E5
                        osc2.type = 'sine';
                        gain2.gain.value = 0.3;
                        osc2.start();
                        osc2.stop(audioContext.currentTime + 0.2);
                    }, 100);
                    break;
                    
                case 'click':
                    oscillator.frequency.value = 800;
                    oscillator.type = 'sine';
                    gainNode.gain.value = 0.3;
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.1);
                    break;
            }
        }

        // แสดง confetti
        function showConfetti() {
            const colors = ['#667eea', '#764ba2', '#4CAF50', '#ff6b6b', '#ffd93d'];
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 2 + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }, i * 50);
            }
        }

        // กลับหน้าหลัก
        function goHome() {
            playSound('click');
            window.location.href = 'index.html';
        }

        // XP SYSTEM: Sync with localStorage and update live
function getXP() {
    return parseInt(localStorage.getItem('setTheoryXP') || '0', 10);
}
function setXP(xp) {
    localStorage.setItem('setTheoryXP', xp);
    updateXPDisplay();
}
function addXP(amount) {
    let xp = getXP();
    xp += amount;
    setXP(xp);
}
function updateXPDisplay() {
    const xp = getXP();
    // For header XP display
    const el = document.getElementById('xp-display');
    if (el) el.textContent = `XP: ${xp}`;
    // For other XP displays (if any)
    const el2 = document.getElementById('currentXP');
    if (el2) el2.textContent = xp;
}
window.addEventListener('DOMContentLoaded', updateXPDisplay);

        // เริ่มต้นเมื่อโหลดหน้า
        window.addEventListener('load', initGame);
    </script>
</body>
</html>