<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ö‡∏ó‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏ã‡∏ï‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏ã‡∏ï</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4f46e5;
            --secondary-color: #06b6d4;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, var(--bg-light) 0%, #e2e8f0 100%);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px 20px;
            background: var(--bg-white);
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        .lesson-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .theory-card {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow-md);
        }

        .theory-card h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .theory-card h3 {
            font-size: 1.3rem;
            font-weight: 500;
            color: var(--text-primary);
            margin: 20px 0 10px 0;
        }

        .example-box {
            background: var(--bg-light);
            border-left: 4px solid var(--secondary-color);
            padding: 20px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
        }

        .example-box h4 {
            color: var(--secondary-color);
            margin-bottom: 10px;
        }

        .math-notation {
            font-family: 'Inter', sans-serif;
            font-size: 1.1rem;
            background: #f1f5f9;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
        }

        .game-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow-md);
            margin-bottom: 30px;
        }

        .game-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 20px;
            text-align: center;
        }

        .drag-drop-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .drag-items {
            background: var(--bg-light);
            border-radius: 10px;
            padding: 20px;
            min-height: 200px;
        }

        .drag-items h4 {
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .draggable-item {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            padding: 8px 15px;
            margin: 5px;
            border-radius: 20px;
            cursor: move;
            user-select: none;
            transition: all 0.3s ease;
        }

        .draggable-item:hover {
            background: var(--secondary-color);
            transform: scale(1.05);
        }

        .draggable-item.dragging {
            opacity: 0.5;
        }

        .draggable-item.wrong {
            background: var(--error-color) !important;
            animation: shake 0.5s ease-in-out;
        }

        /* Touch-specific styles */
        .draggable-item {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* Prevent text selection during drag */
        body.dragging {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .drop-zones {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .drop-zone {
            background: var(--bg-light);
            border: 2px dashed var(--text-secondary);
            border-radius: 10px;
            padding: 20px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .drop-zone.dragover {
            border-color: var(--primary-color);
            background: #e0e7ff;
        }

        .drop-zone h4 {
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .quiz-section {
            background: var(--bg-white);
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow-md);
            margin-bottom: 30px;
        }

        .quiz-card {
            background: var(--bg-light);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .quiz-card.flipped {
            background: var(--success-color);
            color: white;
        }

        .quiz-question {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 15px;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .quiz-option {
            background: var(--bg-white);
            border: 2px solid var(--text-secondary);
            border-radius: 8px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            border-color: var(--primary-color);
        }

        .quiz-option.selected {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .quiz-option.correct {
            background: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .quiz-option.wrong {
            background: var(--error-color);
            color: white;
            border-color: var(--error-color);
        }

        .btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: var(--text-secondary);
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: var(--text-secondary);
        }

        .btn-secondary:hover {
            background: var(--primary-color);
        }

        .controls {
            text-align: center;
            margin-top: 30px;
        }

        .feedback {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: left;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s ease;
            line-height: 1.6;
            white-space: pre-line;
        }

        .feedback.show {
            opacity: 1;
        }

        .feedback.error {
            background: #fee2e2;
            color: var(--error-color);
            border: 1px solid var(--error-color);
        }

        .feedback.success {
            background: #d1fae5;
            color: var(--success-color);
            border: 1px solid var(--success-color);
            text-align: center;
        }

        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--primary-color);
            animation: confetti-fall 3s linear infinite;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .drag-drop-area {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üìö ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏ã‡∏ï‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏ã‡∏ï</h1>
            <p>‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Å‡∏±‡∏ö‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏ï ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏ã‡∏ï ‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏ï‡πà‡∏≤‡∏á ‡πÜ</p>
            <div id="xp-display" style="margin-top:12px;font-size:1.1rem;color:#10b981;font-weight:600;">XP: 0</div>
        </div>

        <!-- ‡∏ó‡∏§‡∏©‡∏é‡∏µ‡∏´‡∏•‡∏±‡∏Å -->
        <div class="lesson-content">
            <div class="theory-card">
                <h2>üéØ ‡∏ó‡∏§‡∏©‡∏é‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</h2>
                
                <h3>‡πÄ‡∏ã‡∏ï (Set) ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?</h3>
                <p><strong>‡πÄ‡∏ã‡∏ï</strong> ‡∏Ñ‡∏∑‡∏≠ ‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏™‡∏¥‡πà‡∏á‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô ‡πÇ‡∏î‡∏¢‡∏™‡∏¥‡πà‡∏á‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ <strong>‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏ï</strong></p>
                
                <div class="example-box">
                    <h4>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:</h4>
                    <p>‚Ä¢ ‡πÄ‡∏ã‡∏ï‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 10 = {1, 3, 5, 7, 9}</p>
                    <p>‚Ä¢ ‡πÄ‡∏ã‡∏ï‡∏Ç‡∏≠‡∏á‡∏™‡∏µ‡∏ò‡∏á‡∏ä‡∏≤‡∏ï‡∏¥‡πÑ‡∏ó‡∏¢ = {‡πÅ‡∏î‡∏á, ‡∏Ç‡∏≤‡∏ß, ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô}</p>
                    <p>‚Ä¢ ‡πÄ‡∏ã‡∏ï‡∏Ç‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ = {1, 2, 3, 4, 5, ...}</p>
                </div>

                <h3>‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏ã‡∏ï</h3>
                <p><strong>1. ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏à‡∏Å‡πÅ‡∏à‡∏á (Roster Method)</strong> - ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÄ‡∏ã‡∏ï</p>
                <div class="math-notation">A = {1, 2, 3, 4, 5}</div>
                
                <p><strong>2. ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥ (Set-builder Notation)</strong> - ‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</p>
                <div class="math-notation">B = {x | x ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏π‡πà ‡πÅ‡∏•‡∏∞ x < 10}</div>
                
                <h3>‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h3>
                <p>‚Ä¢ <strong>‚àà</strong> ‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤ "‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Ç‡∏≠‡∏á" ‡πÄ‡∏ä‡πà‡∏ô 3 ‚àà A</p>
                <p>‚Ä¢ <strong>‚àâ</strong> ‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤ "‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Ç‡∏≠‡∏á" ‡πÄ‡∏ä‡πà‡∏ô 6 ‚àâ A</p>
                <p>‚Ä¢ <strong>{ }</strong> ‡∏´‡∏£‡∏∑‡∏≠ <strong>‚àÖ</strong> ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á "‡πÄ‡∏ã‡∏ï‡∏ß‡πà‡∏≤‡∏á"</p>
                <p>‚Ä¢ <strong>‚Ñï</strong> = ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥, <strong>‚Ñ§</strong> = ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡πá‡∏°, <strong>‚Ñù</strong> = ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á</p>
            </div>
        </div>

        <!-- ‡πÄ‡∏Å‡∏° Drag and Drop -->
        <div class="game-section">
            <div class="game-title">üéÆ ‡πÄ‡∏Å‡∏° 1: ‡∏•‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏ã‡∏ï</div>
            <p style="text-align: center; margin-bottom: 20px;">
    ‡∏•‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô‡πÄ‡∏ã‡∏ï‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°<br>
    <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏≤‡∏à‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡πÄ‡∏ã‡∏ï
</p>
            
            <div class="drag-drop-area">
                <div class="drag-items">
                    <h4>‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á:</h4>
                    <div class="draggable-item" draggable="true" data-value="1">1</div>
                    <div class="draggable-item" draggable="true" data-value="2">2</div>
                    <div class="draggable-item" draggable="true" data-value="3">3</div>
                    <div class="draggable-item" draggable="true" data-value="-1">-1</div>
                    <div class="draggable-item" draggable="true" data-value="0">0</div>
                    <div class="draggable-item" draggable="true" data-value="œÄ">œÄ</div>
                    <div class="draggable-item" draggable="true" data-value="1/2">1/2</div>
                    <div class="draggable-item" draggable="true" data-value="üéæ">üéæ</div>
                    <div id="fixed-hint-area" style="display:none;opacity:0;transition:opacity 0.3s;margin-top:18px;padding:16px 18px;background:#f1f5f9;border-radius:10px;min-height:32px;font-size:1.08rem;color:#1e293b;box-shadow:0 1px 4px rgba(0,0,0,0.04);"></div>
                </div>
                
                <div class="drop-zones">
                    <div class="drop-zone" data-set="natural">
                        <div>
                            <h4>‚Ñï (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥)</h4>
                            <div class="dropped-items" id="natural-items"></div>
                        </div>
                    </div>
                    <div class="drop-zone" data-set="integer">
                        <div>
                            <h4>‚Ñ§ (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡πá‡∏°)</h4>
                            <div class="dropped-items" id="integer-items"></div>
                        </div>
                    </div>
                    <div class="drop-zone" data-set="real">
                        <div>
                            <h4>‚Ñù (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á)</h4>
                            <div class="dropped-items" id="real-items"></div>
                        </div>
                    </div>
                    <div class="drop-zone" data-set="other">
                        <div>
                            <h4>‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</h4>
                            <div class="dropped-items" id="other-items"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn" onclick="checkDragDropAnswer()">‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
                <button class="btn btn-secondary" onclick="resetDragDrop()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
            </div>
            
            <div class="feedback" id="dragDropFeedback"></div>
        </div>

        <!-- ‡πÄ‡∏Å‡∏° Quiz Cards -->
        <div class="quiz-section">
            <div class="game-title">üéÆ ‡πÄ‡∏Å‡∏° 2: ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</div>
            <p style="text-align: center; margin-bottom: 20px;">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
            
            <div class="quiz-card" id="quiz1">
                <div class="quiz-question">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° 1: ‡πÄ‡∏ã‡∏ï‡∏ß‡πà‡∏≤‡∏á ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏ã‡∏ï‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î?</div>
                <div class="quiz-options">
                    <div class="quiz-option" onclick="selectQuizOption(1, 0, false)">1 ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
                    <div class="quiz-option" onclick="selectQuizOption(1, 1, true)">0 ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
                    <div class="quiz-option" onclick="selectQuizOption(1, 2, false)">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏µ‡∏î‡∏à‡∏≥‡∏Å‡∏±‡∏î</div>
                    <div class="quiz-option" onclick="selectQuizOption(1, 3, false)">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏≠‡∏Å‡πÑ‡∏î‡πâ</div>
                </div>
            </div>
            
            <div class="quiz-card" id="quiz2">
                <div class="quiz-question">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° 2: ‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå ‚àà ‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?</div>
                <div class="quiz-options">
                    <div class="quiz-option" onclick="selectQuizOption(2, 0, false)">‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Ç‡∏≠‡∏á</div>
                    <div class="quiz-option" onclick="selectQuizOption(2, 1, true)">‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Ç‡∏≠‡∏á</div>
                    <div class="quiz-option" onclick="selectQuizOption(2, 2, false)">‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö</div>
                    <div class="quiz-option" onclick="selectQuizOption(2, 3, false)">‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö</div>
                </div>
            </div>
            
            <div class="quiz-card" id="quiz3">
                <div class="quiz-question">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° 3: A = {x | x ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏µ‡πà ‡πÅ‡∏•‡∏∞ 1 ‚â§ x ‚â§ 7} ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏à‡∏Å‡πÅ‡∏à‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô?</div>
                <div class="quiz-options">
                    <div class="quiz-option" onclick="selectQuizOption(3, 0, false)">{1, 2, 3, 4, 5, 6, 7}</div>
                    <div class="quiz-option" onclick="selectQuizOption(3, 1, true)">{1, 3, 5, 7}</div>
                    <div class="quiz-option" onclick="selectQuizOption(3, 2, false)">{2, 4, 6}</div>
                    <div class="quiz-option" onclick="selectQuizOption(3, 3, false)">{1, 3, 5, 7, 9}</div>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn" onclick="checkAllQuizAnswers()">‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                <button class="btn btn-secondary" onclick="resetQuiz()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
            </div>
            
            <div class="feedback" id="quizFeedback"></div>
        </div>

        <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° -->
        <div class="controls">
            <button class="btn btn-secondary" onclick="goHome()">üè† ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</button>
            <button class="btn" onclick="completeLesson()">üéâ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
        </div>
    </div>

    <script>
        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡∏°
        let dragDropCompleted = false;
        let quizCompleted = false;
        let quizAnswers = [false, false, false];
        
        // ‡πÄ‡∏Å‡∏° Drag and Drop
        function initializeDragDrop() {
            const draggables = document.querySelectorAll('.drag-items .draggable-item');
            const dropZones = document.querySelectorAll('.drop-zone');
            // Remove old listeners by cloning (to avoid duplicate listeners)
            draggables.forEach(item => {
                const newItem = item.cloneNode(true);
                item.parentNode.replaceChild(newItem, item);
            });
            // Re-select after cloning
            const freshDraggables = document.querySelectorAll('.drag-items .draggable-item');
            freshDraggables.forEach(item => {
                item.setAttribute('draggable', 'true');
                
                // Mouse events for desktop
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
                item.addEventListener('mouseenter', handleHintMouseEnter);
                item.addEventListener('mouseleave', handleHintMouseLeave);
                item.addEventListener('click', handleHintTouchOrClick);
                
                // Touch events for mobile
                item.addEventListener('touchstart', handleTouchStart, {passive: false});
                item.addEventListener('touchmove', handleTouchMove, {passive: false});
                item.addEventListener('touchend', handleTouchEnd, {passive: false});
                item.addEventListener('touchcancel', handleTouchCancel, {passive: false});
            });
            
            dropZones.forEach(zone => {
                // Mouse events for desktop
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragenter', handleDragEnter);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
                
                // Touch events for mobile
                zone.addEventListener('touchstart', handleZoneTouchStart, {passive: false});
                zone.addEventListener('touchmove', handleZoneTouchMove, {passive: false});
                zone.addEventListener('touchend', handleZoneTouchEnd, {passive: false});
            });
            updateItemUsage();
        }
        
        let draggedItem = null;
        
        function handleDragStart(e) {
            draggedItem = e.target;
            e.target.classList.add('dragging');
        }
        
        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }
        
        function handleDragOver(e) {
            e.preventDefault();
        }
        
        function handleDragEnter(e) {
            e.target.classList.add('dragover');
        }
        
        function handleDragLeave(e) {
            e.target.classList.remove('dragover');
        }
        
        function handleDrop(e) {
            e.preventDefault();
            e.target.classList.remove('dragover');

            const dropZone = e.target.closest('.drop-zone');
            const droppedItems = dropZone.querySelector('.dropped-items');

            if (draggedItem) {
                // Prevent duplicate in the same drop zone
                const value = draggedItem.getAttribute('data-value');
                const max = itemMaxUsage[value];
                const used = itemUsage[value] || 0;
                const alreadyExists = Array.from(droppedItems.children).some(
                    item => item.getAttribute('data-value') === value
                );
                // Only allow drop if not exceeding max usage
                if (!alreadyExists && used < max) {
                    // Create a copy in the drop zone
                    const newItem = draggedItem.cloneNode(true);
                    newItem.classList.remove('dragging');
                    newItem.style.margin = '2px';
                    newItem.style.fontSize = '0.9rem';
                    newItem.setAttribute('draggable', 'false');
                    // Add remove-on-click for dropped items
                    newItem.addEventListener('click', function(e) {
                        e.stopPropagation();
                        this.remove();
                        hideFixedHintArea();
                        updateItemUsage();
                    });
                    droppedItems.appendChild(newItem);
                    updateItemUsage();
                }
                // Do NOT remove the original from the pool!
                draggedItem = null;
            }
            // Re-initialize drag events for pool items (in case DOM changed)
            initializeDragDrop();
        }
        
        // Touch event handlers for mobile devices
        let touchStartX = 0;
        let touchStartY = 0;
        let touchStartTime = 0;
        let isDragging = false;
        let touchDraggedItem = null;
        let touchStartElement = null;
        
        function handleTouchStart(e) {
            e.preventDefault();
            const touch = e.touches[0];
            touchStartX = touch.clientX;
            touchStartY = touch.clientY;
            touchStartTime = Date.now();
            touchStartElement = e.target;
            isDragging = false;
            touchDraggedItem = e.target;
            
            // Add visual feedback
            e.target.style.transform = 'scale(1.1)';
            e.target.style.zIndex = '1000';
        }
        
        function handleTouchMove(e) {
            e.preventDefault();
            if (!touchDraggedItem) return;
            
            const touch = e.touches[0];
            const deltaX = touch.clientX - touchStartX;
            const deltaY = touch.clientY - touchStartY;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            
            // Start dragging after moving 10px
            if (distance > 10 && !isDragging) {
                isDragging = true;
                touchDraggedItem.classList.add('dragging');
                document.body.classList.add('dragging');
            }
            
            if (isDragging) {
                // Move the dragged item with touch
                touchDraggedItem.style.position = 'fixed';
                touchDraggedItem.style.left = (touch.clientX - touchDraggedItem.offsetWidth / 2) + 'px';
                touchDraggedItem.style.top = (touch.clientY - touchDraggedItem.offsetHeight / 2) + 'px';
                touchDraggedItem.style.pointerEvents = 'none';
                
                // Highlight drop zones
                const dropZones = document.querySelectorAll('.drop-zone');
                dropZones.forEach(zone => {
                    const rect = zone.getBoundingClientRect();
                    if (touch.clientX >= rect.left && touch.clientX <= rect.right &&
                        touch.clientY >= rect.top && touch.clientY <= rect.bottom) {
                        zone.classList.add('dragover');
                    } else {
                        zone.classList.remove('dragover');
                    }
                });
            }
        }
        
        function handleTouchEnd(e) {
            e.preventDefault();
            if (!touchDraggedItem) return;
            
            const touch = e.changedTouches[0];
            const deltaTime = Date.now() - touchStartTime;
            
            // If it was a short tap (not a drag), treat as click for hint
            if (deltaTime < 300 && !isDragging) {
                handleHintTouchOrClick(e);
            } else if (isDragging) {
                // Find the drop zone under the touch
                const dropZones = document.querySelectorAll('.drop-zone');
                let targetDropZone = null;
                
                dropZones.forEach(zone => {
                    const rect = zone.getBoundingClientRect();
                    if (touch.clientX >= rect.left && touch.clientX <= rect.right &&
                        touch.clientY >= rect.top && touch.clientY <= rect.bottom) {
                        targetDropZone = zone;
                    }
                    zone.classList.remove('dragover');
                });
                
                if (targetDropZone) {
                    // Simulate drop
                    const droppedItems = targetDropZone.querySelector('.dropped-items');
                    const value = touchDraggedItem.getAttribute('data-value');
                    const max = itemMaxUsage[value];
                    const used = itemUsage[value] || 0;
                    const alreadyExists = Array.from(droppedItems.children).some(
                        item => item.getAttribute('data-value') === value
                    );
                    
                    if (!alreadyExists && used < max) {
                        const newItem = touchDraggedItem.cloneNode(true);
                        newItem.classList.remove('dragging');
                        newItem.style.margin = '2px';
                        newItem.style.fontSize = '0.9rem';
                        newItem.setAttribute('draggable', 'false');
                        newItem.style.position = 'static';
                        newItem.style.transform = 'none';
                        newItem.style.zIndex = 'auto';
                        newItem.style.pointerEvents = 'auto';
                        
                        // Add remove-on-tap for dropped items
                        newItem.addEventListener('touchstart', function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                            this.remove();
                            hideFixedHintArea();
                            updateItemUsage();
                        });
                        
                        droppedItems.appendChild(newItem);
                        updateItemUsage();
                    }
                }
            }
            
            // Reset dragged item
            if (touchDraggedItem) {
                touchDraggedItem.classList.remove('dragging');
                touchDraggedItem.style.position = 'static';
                touchDraggedItem.style.left = 'auto';
                touchDraggedItem.style.top = 'auto';
                touchDraggedItem.style.transform = 'none';
                touchDraggedItem.style.zIndex = 'auto';
                touchDraggedItem.style.pointerEvents = 'auto';
            }
            
            // Remove body dragging class
            document.body.classList.remove('dragging');
            
            touchDraggedItem = null;
            isDragging = false;
            touchStartElement = null;
        }
        
        function handleTouchCancel(e) {
            e.preventDefault();
            if (touchDraggedItem) {
                touchDraggedItem.classList.remove('dragging');
                touchDraggedItem.style.position = 'static';
                touchDraggedItem.style.left = 'auto';
                touchDraggedItem.style.top = 'auto';
                touchDraggedItem.style.transform = 'none';
                touchDraggedItem.style.zIndex = 'auto';
                touchDraggedItem.style.pointerEvents = 'auto';
            }
            touchDraggedItem = null;
            isDragging = false;
            touchStartElement = null;
            
            // Remove body dragging class
            document.body.classList.remove('dragging');
            
            // Remove dragover from all zones
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.classList.remove('dragover');
            });
        }
        
        // Touch handlers for drop zones (for visual feedback)
        function handleZoneTouchStart(e) {
            // Prevent default to avoid conflicts with item touch handling
            e.preventDefault();
        }
        
        function handleZoneTouchMove(e) {
            // This is handled in the item touch move
            e.preventDefault();
        }
        
        function handleZoneTouchEnd(e) {
            // This is handled in the item touch end
            e.preventDefault();
        }
        
        function checkDragDropAnswer() {
            const correctAnswers = {
                'natural': ['1', '2', '3'],
                'integer': ['1', '2', '3', '-1', '0'],
                'real': ['1', '2', '3', '-1', '0', 'œÄ', '1/2'],
                'other': ['üéæ']
            };
            
            let allCorrect = true;
            let totalScore = 0;
            let feedbackMessages = [];
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏ã‡∏ï
            Object.keys(correctAnswers).forEach(setType => {
                const droppedItems = document.querySelectorAll(`#${setType}-items .draggable-item`);
                const droppedValues = Array.from(droppedItems).map(item => item.getAttribute('data-value'));
                
                // ‡∏´‡∏≤‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ú‡∏¥‡∏î
                const correctInSet = droppedValues.filter(value => correctAnswers[setType].includes(value));
                const wrongInSet = droppedValues.filter(value => !correctAnswers[setType].includes(value));
                
                // ‡∏´‡∏≤‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏ã‡∏ï‡∏ô‡∏µ‡πâ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà
                const missingFromSet = correctAnswers[setType].filter(value => !droppedValues.includes(value));
                
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
                correctInSet.forEach(value => {
                    totalScore += 10;
                });
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° feedback
                let setFeedback = '';
                const setNames = {
                    'natural': '‚Ñï (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥)',
                    'integer': '‚Ñ§ (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡πá‡∏°)',
                    'real': '‚Ñù (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á)',
                    'other': '‡∏≠‡∏∑‡πà‡∏ô ‡πÜ'
                };
                
                if (wrongInSet.length > 0) {
                    setFeedback += `‚ùå ‡πÉ‡∏ô ${setNames[setType]}: ${wrongInSet.join(', ')} ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà\n`;
                    allCorrect = false;
                }
                
                if (missingFromSet.length > 0) {
                    setFeedback += `‚ö†Ô∏è ‡πÉ‡∏ô ${setNames[setType]}: ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ ${missingFromSet.join(', ')}\n`;
                    allCorrect = false;
                }
                
                if (setFeedback) {
                    feedbackMessages.push(setFeedback);
                }
            });
            
            const feedback = document.getElementById('dragDropFeedback');
            
            if (allCorrect && totalScore >= 70) {
                feedback.innerHTML = 'üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏±‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
                feedback.className = 'feedback success show';
                dragDropCompleted = true;
                playSuccessSound();
                showConfetti();
            } else {
                // ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå items ‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î
                highlightWrongItems(correctAnswers);
                
                let feedbackText = `‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${totalScore}/100)\n\n`;
                feedbackText += '<strong>‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</strong>\n';
                feedbackText += feedbackMessages.join('\n');
                feedbackText += '\nüí° <strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong>\n';
                feedbackText += '‚Ä¢ ‚Ñï (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥): 1, 2, 3, 4, 5, ...\n';
                feedbackText += '‚Ä¢ ‚Ñ§ (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡πá‡∏°): ..., -2, -1, 0, 1, 2, ...\n';
                feedbackText += '‚Ä¢ ‚Ñù (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á): ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡πÄ‡∏®‡∏©‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏ï‡∏£‡∏£‡∏Å‡∏¢‡∏∞\n';
                feedbackText += '‚Ä¢ ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ: ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç';
                
                feedback.innerHTML = feedbackText.replace(/\n/g, '<br>');
                feedback.className = 'feedback error show';
            }
        }
        
        function highlightWrongItems(correctAnswers) {
            // ‡∏•‡∏ö highlighting ‡πÄ‡∏Å‡πà‡∏≤
            document.querySelectorAll('.draggable-item.wrong').forEach(item => {
                item.classList.remove('wrong');
            });
            
            // ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå items ‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î
            Object.keys(correctAnswers).forEach(setType => {
                const droppedItems = document.querySelectorAll(`#${setType}-items .draggable-item`);
                droppedItems.forEach(item => {
                    const value = item.getAttribute('data-value');
                    if (!correctAnswers[setType].includes(value)) {
                        item.classList.add('wrong');
                    }
                });
            });
        }

        function resetDragDrop() {
            // Clear all drop zones
            document.querySelectorAll('.dropped-items').forEach(container => {
                container.innerHTML = '';
            });

            // Remove highlighting
            document.querySelectorAll('.draggable-item.wrong').forEach(item => {
                item.classList.remove('wrong');
            });

            // Reset any ongoing touch drag
            if (touchDraggedItem) {
                touchDraggedItem.classList.remove('dragging');
                touchDraggedItem.style.position = 'static';
                touchDraggedItem.style.left = 'auto';
                touchDraggedItem.style.top = 'auto';
                touchDraggedItem.style.transform = 'none';
                touchDraggedItem.style.zIndex = 'auto';
                touchDraggedItem.style.pointerEvents = 'auto';
            }
            touchDraggedItem = null;
            isDragging = false;
            touchStartElement = null;

            // Restore the drag pool (if needed)
            const dragItems = document.querySelector('.drag-items');
            dragItems.innerHTML = `
                <h4>‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á:</h4>
                <div class="draggable-item" draggable="true" data-value="1">1</div>
                <div class="draggable-item" draggable="true" data-value="2">2</div>
                <div class="draggable-item" draggable="true" data-value="3">3</div>
                <div class="draggable-item" draggable="true" data-value="-1">-1</div>
                <div class="draggable-item" draggable="true" data-value="0">0</div>
                <div class="draggable-item" draggable="true" data-value="œÄ">œÄ</div>
                <div class="draggable-item" draggable="true" data-value="1/2">1/2</div>
                <div class="draggable-item" draggable="true" data-value="üéæ">üéæ</div>
                <div id="fixed-hint-area" style="display:none;opacity:0;transition:opacity 0.3s;margin-top:18px;padding:16px 18px;background:#f1f5f9;border-radius:10px;min-height:32px;font-size:1.08rem;color:#1e293b;box-shadow:0 1px 4px rgba(0,0,0,0.04);"></div>
            `;

            initializeDragDrop();

            const feedback = document.getElementById('dragDropFeedback');
            feedback.className = 'feedback';
            dragDropCompleted = false;
            updateItemUsage();
            hideFixedHintArea();
        }
        
        // ‡πÄ‡∏Å‡∏° Quiz
        function selectQuizOption(quizNum, optionIndex, isCorrect) {
            const quiz = document.getElementById(`quiz${quizNum}`);
            const options = quiz.querySelectorAll('.quiz-option');
            
            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Å‡πà‡∏≤
            options.forEach(option => {
                option.classList.remove('selected', 'correct', 'wrong');
            });
            
            // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà
            options[optionIndex].classList.add('selected');
            quizAnswers[quizNum - 1] = isCorrect;
        }
        
        function checkAllQuizAnswers() {
            const allAnswered = quizAnswers.every(answer => answer !== false);
            const allCorrect = quizAnswers.every(answer => answer === true);
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
            for (let i = 1; i <= 3; i++) {
                const quiz = document.getElementById(`quiz${i}`);
                const options = quiz.querySelectorAll('.quiz-option');
                
                options.forEach((option, index) => {
                    if (option.classList.contains('selected')) {
                        if (quizAnswers[i - 1] === true) {
                            option.classList.add('correct');
                        } else {
                            option.classList.add('wrong');
                        }
                    }
                });
            }
            
            const feedback = document.getElementById('quizFeedback');
            const correctCount = quizAnswers.filter(answer => answer === true).length;
            
            if (allCorrect) {
                feedback.textContent = `üéâ ‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${correctCount}/3 ‡∏Ç‡πâ‡∏≠`;
                feedback.className = 'feedback success show';
                quizCompleted = true;
                playSuccessSound();
                showConfetti();
            } else {
                feedback.textContent = `üìù ‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å ${correctCount}/3 ‡∏Ç‡πâ‡∏≠ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á`;
                feedback.className = 'feedback error show';
            }
        }
        
        function resetQuiz() {
            quizAnswers = [false, false, false];
            quizCompleted = false;
            
            document.querySelectorAll('.quiz-option').forEach(option => {
                option.classList.remove('selected', 'correct', 'wrong');
            });
            
            const feedback = document.getElementById('quizFeedback');
            feedback.className = 'feedback';
        }
        
        // ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡πá‡∏Å‡∏ï‡πå
        function playSuccessSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }
        
        // ‡πÅ‡∏™‡∏î‡∏á Confetti
        function showConfetti() {
            const confetti = document.createElement('div');
            confetti.classList.add('confetti');
            document.body.appendChild(confetti);
            
            const colors = ['#4f46e5', '#06b6d4', '#10b981', '#f59e0b', '#ef4444'];
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const piece = document.createElement('div');
                    piece.classList.add('confetti-piece');
                    piece.style.left = Math.random() * 100 + 'vw';
                    piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    piece.style.animationDelay = Math.random() * 2 + 's';
                    confetti.appendChild(piece);
                }, i * 50);
            }
            
            setTimeout(() => {
                confetti.remove();
            }, 3000);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏ó‡∏≤‡∏á
        function goHome() {
            window.location.href = 'index.html';
        }
        
        function completeLesson() {
            if (dragDropCompleted && quizCompleted) {
                // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (local XP)
                if (!isLessonCompleted(1)) {
                    addXP(100);
                    markLessonCompleted(1);
                    alert('üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà 1 ‡πÅ‡∏•‡πâ‡∏ß\n‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö 100 XP!');
                } else {
                    alert('‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß XP ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ã‡πâ‡∏≥');
                }
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 1000);
            } else {
                alert('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ó‡∏≥‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏ö‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô');
            }
        }
        
        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
        window.addEventListener('load', function() {
            initializeDragDrop();
            updateItemUsage();
            updateXPDisplay();
            // ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡πá‡∏Å‡∏ï‡πå fade in
            document.body.style.opacity = '0';
            setTimeout(() => {
                document.body.style.transition = 'opacity 0.5s ease';
                document.body.style.opacity = '1';
            }, 100);
        });

        // --- Fixed hint area logic ---
        let lastHintValue = null;
        let hintTimer = null;
        function showHintInFixedAreaFor(value) {
            const sets = itemHints[value] || [];
            const hintArea = document.getElementById('fixed-hint-area');
            if (!sets.length) return;
            hintArea.innerHTML = `<strong>‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Ç‡∏≠‡∏á:</strong> ${sets.map(s => `<span style='display:inline-block;background:#e0e7ff;color:#4f46e5;padding:2px 10px;border-radius:7px;margin:0 4px;'>${s}</span>`).join('')}`;
            hintArea.style.display = 'block';
            setTimeout(() => { hintArea.style.opacity = '1'; }, 10);
            lastHintValue = value;
        }
        function hideFixedHintArea() {
            const hintArea = document.getElementById('fixed-hint-area');
            hintArea.style.opacity = '0';
            setTimeout(() => { hintArea.style.display = 'none'; }, 300);
            lastHintValue = null;
        }
        // Hover logic for desktop
        function handleHintMouseEnter(e) {
            const value = e.target.getAttribute('data-value');
            clearTimeout(hintTimer);
            hintTimer = setTimeout(() => {
                showHintInFixedAreaFor(value);
            }, 2000);
        }
        function handleHintMouseLeave(e) {
            clearTimeout(hintTimer);
            hideFixedHintArea();
        }
        // Touch/click fallback for mobile
        function handleHintTouchOrClick(e) {
            e.preventDefault();
            e.stopPropagation();
            const value = e.target.getAttribute('data-value');
            if (lastHintValue === value && document.getElementById('fixed-hint-area').style.opacity === '1') {
                hideFixedHintArea();
                return;
            }
            showHintInFixedAreaFor(value);
        }
        document.addEventListener('mousedown', function(e) {
            const hintArea = document.getElementById('fixed-hint-area');
            if (!hintArea.contains(e.target) && !e.target.classList.contains('draggable-item')) {
                hideFixedHintArea();
            }
        });
        document.addEventListener('touchstart', function(e) {
            const hintArea = document.getElementById('fixed-hint-area');
            if (!hintArea.contains(e.target) && !e.target.classList.contains('draggable-item')) {
                hideFixedHintArea();
            }
        });
        // --- Tooltip logic ---
        const itemHints = {
            '1': ['‚Ñï', '‚Ñ§', '‚Ñù'],
            '2': ['‚Ñï', '‚Ñ§', '‚Ñù'],
            '3': ['‚Ñï', '‚Ñ§', '‚Ñù'],
            '-1': ['‚Ñ§', '‚Ñù'],
            '0': ['‚Ñ§', '‚Ñù'],
            'œÄ': ['‚Ñù'],
            '1/2': ['‚Ñù'],
            'üéæ': ['‡∏≠‡∏∑‡πà‡∏ô ‡πÜ']
        };
        // For usage count: items that can be used more than once
        const itemMaxUsage = {
            '1': 3, // can be in 3 sets
            '2': 3,
            '3': 3,
            '-1': 2,
            '0': 2,
            'œÄ': 1,
            '1/2': 1,
            'üéæ': 1
        };
        // Track current usage
        let itemUsage = {};
        function updateItemUsage() {
            // Count how many times each item is used in drop zones
            itemUsage = {};
            Object.keys(itemMaxUsage).forEach(val => itemUsage[val] = 0);
            document.querySelectorAll('.dropped-items .draggable-item').forEach(item => {
                const value = item.getAttribute('data-value');
                if (itemUsage[value] !== undefined) itemUsage[value]++;
            });
            // Update pool item UI
            document.querySelectorAll('.drag-items .draggable-item').forEach(item => {
                const value = item.getAttribute('data-value');
                const max = itemMaxUsage[value];
                const used = itemUsage[value];
                // Show badge for usage count if max > 1
                let badge = item.querySelector('.usage-badge');
                if (!badge && max > 1) {
                    badge = document.createElement('span');
                    badge.className = 'usage-badge';
                    badge.style.background = '#06b6d4';
                    badge.style.color = '#fff';
                    badge.style.fontSize = '0.8em';
                    badge.style.borderRadius = '8px';
                    badge.style.padding = '2px 7px';
                    badge.style.marginLeft = '7px';
                    badge.style.verticalAlign = 'middle';
                    item.appendChild(badge);
                }
                if (badge) badge.textContent = `${max - used}`;
                if (max === 1 && used >= 1) {
                    item.style.opacity = '0.4';
                    item.style.pointerEvents = 'none';
                } else if (max > 1 && used >= max) {
                    item.style.opacity = '0.4';
                    item.style.pointerEvents = 'none';
                } else {
                    item.style.opacity = '1';
                    item.style.pointerEvents = '';
                }
            });
        }

        // Local XP system (sync with home page)
        function getXP() {
            return parseInt(localStorage.getItem('setTheoryXP') || '0', 10);
        }
        function setXP(xp) {
            localStorage.setItem('setTheoryXP', xp);
            updateXPDisplay();
        }
        function addXP(amount) {
            let xp = getXP();
            xp += amount;
            setXP(xp);
        }
        function updateXPDisplay() {
            const xp = getXP();
            const el = document.getElementById('xp-display');
            if (el) el.textContent = `XP: ${xp}`;
        }
        // Track completed lessons to prevent double XP (sync with home page)
        function isLessonCompleted(lessonId) {
            return localStorage.getItem(`lesson${lessonId}_completed`) === 'true';
        }
        function markLessonCompleted(lessonId) {
            localStorage.setItem(`lesson${lessonId}_completed`, 'true');
        }
    </script>
</body>
</html>
